---
import Layout from "../../layouts/Layout.astro";
---

<Layout title="Fernando Montano | Contact">
    <main>
        <section class="min-h-screen">
            <div class="flex relative min-h-screen max-w-325 justify-center flex-col items-center px-8 mx-auto text-[#5b575a] py-16">
                
                <div class="w-full max-w-150 flex flex-col gap-6">
                    <div class="text-center md:text-left">
                        <p class="font-bold">Let's talk. üí¨</p>
                        <h1 class="font-[Manrope] text-2xl mt-2">Get in Touch</h1>
                        <p class="max-w-100 mt-2">Have a project in mind or just want to say hello? <span class="font-bold">I'd love to hear from you.</span></p>
                    </div>

                    <form id="contact-form" class="flex flex-col gap-4 mt-4">
                        <div class="flex flex-col md:flex-row gap-4">
                            <div class="flex flex-col gap-1.5 flex-1">
                                <label for="name" class="font-bold text-sm">Name</label>
                                <input 
                                    type="text" 
                                    id="name" 
                                    name="name" 
                                    required
                                    placeholder="Your name"
                                    class="border border-[#A1B5D8] rounded-xl px-4 py-3 bg-white/50 outline-none focus:border-[#5b575a] focus:ring-1 focus:ring-[#A1B5D8] transition-all placeholder:text-[#5b575a]/40"
                                />
                            </div>
                            <div class="flex flex-col gap-1.5 flex-1">
                                <label for="email" class="font-bold text-sm">Email</label>
                                <input 
                                    type="email" 
                                    id="email" 
                                    name="email" 
                                    required
                                    placeholder="you@example.com"
                                    class="border border-[#A1B5D8] rounded-xl px-4 py-3 bg-white/50 outline-none focus:border-[#5b575a] focus:ring-1 focus:ring-[#A1B5D8] transition-all placeholder:text-[#5b575a]/40"
                                />
                            </div>
                        </div>

                        <div class="flex flex-col gap-1.5">
                            <label for="subject" class="font-bold text-sm">Subject</label>
                            <input 
                                type="text" 
                                id="subject" 
                                name="subject" 
                                required
                                placeholder="What's this about?"
                                class="border border-[#A1B5D8] rounded-xl px-4 py-3 bg-white/50 outline-none focus:border-[#5b575a] focus:ring-1 focus:ring-[#A1B5D8] transition-all placeholder:text-[#5b575a]/40"
                            />
                        </div>

                        <div class="flex flex-col gap-1.5">
                            <label for="message" class="font-bold text-sm">Message</label>
                            <textarea 
                                id="message" 
                                name="message" 
                                required
                                rows="6"
                                placeholder="Tell me about your project..."
                                class="border border-[#A1B5D8] rounded-xl px-4 py-3 bg-white/50 outline-none focus:border-[#5b575a] focus:ring-1 focus:ring-[#A1B5D8] transition-all resize-none placeholder:text-[#5b575a]/40"
                            ></textarea>
                        </div>

                        <button 
                            type="submit"
                            class="border border-[#A1B5D8] p-3 rounded-xl bg-[#a1b5d880] font-bold cursor-pointer hover:bg-[#A1B5D8] transition-all mt-2 active:scale-[0.98]"
                        >
                            Send Message ‚úâÔ∏è
                        </button>

                        <div id="form-status" class="text-center text-sm hidden">
                        </div>
                    </form>

                    <div class="flex justify-center mt-4">
                        <p class="text-[8px]">(i'll get back to you as soon as possible)</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
</Layout>

<script>
    const form = document.getElementById('contact-form') as HTMLFormElement;
    const status = document.getElementById('form-status') as HTMLDivElement;

    form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const button = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        button.textContent = 'Sending... ‚è≥';
        button.disabled = true;

        const formData = new FormData(form);
        const data = Object.fromEntries(formData);

        try {
            const response = await fetch('https://j92cupwp88.execute-api.us-east-2.amazonaws.com/send-email', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data),
            });

            const result = await response.json();

            if (response.ok) {
                status.textContent = 'Message sent successfully! üéâ';
                status.className = 'text-center text-sm text-green-600 font-bold';
                status.classList.remove('hidden');
                form.reset();
            } else {
                throw new Error(result.error || 'Failed to send');
            }
        } catch (error) {
            status.textContent = 'Something went wrong. Please try again.';
            status.className = 'text-center text-sm text-red-500 font-bold';
            status.classList.remove('hidden');
        } finally {
            button.textContent = 'Send Message ‚úâÔ∏è';
            button.disabled = false;
        }
    });
</script>